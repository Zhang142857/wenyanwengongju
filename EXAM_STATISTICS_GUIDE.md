# 题目统计功能使用指南

## 功能概述

题目统计模块会在生成题目后自动显示，提供详细的统计信息，帮助你了解题目的分布情况。

## 统计内容

### 1. 总体统计（顶部卡片）

- **题目总数**：生成的题目数量
- **涉及文章**：题目中涉及的不同文章数量
- **考察字数**：题目中考察的不同字符数量

### 2. 文章分布

显示前10篇出现频率最高的文章及其出现次数。

**示例**：
- 《岳阳楼记》×8
- 《醉翁亭记》×6
- 《桃花源记》×5

**用途**：
- 检查题目是否过于集中在某些文章
- 确认考察范围是否符合预期
- 调整文章权重以平衡分布

### 3. 字符分布

显示前15个出现频率最高的考察字符及其出现次数。

**示例**：
- 而×3
- 以×2
- 之×2

**用途**：
- 了解重点字的考察频率
- 检查是否符合重点字权重设置
- 发现可能被忽略的重要字符

### 4. 义项分布

显示前10个出现频率最高的义项及其出现次数。

**示例**：
- 而（表转折）×2
- 以（用）×2
- 之（的）×1

**用途**：
- 检查义项的多样性
- 避免重复考察相同义项
- 确认义项覆盖是否全面

## 使用场景

### 场景1：检查题目质量

生成题目后，查看统计信息：
1. 如果某篇文章出现次数过多，可能需要调整文章权重
2. 如果某个字出现次数过多，可能需要调整重点字权重
3. 如果义项分布不均，可能需要增加义项数据

### 场景2：优化权重配置

根据统计结果调整权重：
1. 在文章权重图表中降低高频文章的权重
2. 在重点字权重编辑器中调整字符权重
3. 重新生成题目，对比统计结果

### 场景3：验证考察范围

确认题目是否符合教学要求：
1. 检查涉及文章数量是否合理
2. 确认考察字符是否覆盖重点内容
3. 验证义项分布是否符合教学目标

## 统计数据说明

### 文章统计

- 统计方式：遍历所有题目的所有选项，找到每个短句对应的文章
- 计数规则：每个短句计数一次，同一文章的多个短句会累加
- 排序方式：按出现次数从高到低排序

### 字符统计

- 统计方式：
  - 同一个字题型：统计题目考察的字符
  - 不同字题型：统计所有选项考察的字符
- 计数规则：每个字符在每道题中计数一次
- 排序方式：按出现次数从高到低排序

### 义项统计

- 统计方式：
  - 同一个字题型：统计题目的义项
  - 不同字题型：统计所有选项的义项
- 计数规则：每个义项在每道题中计数一次
- 排序方式：按出现次数从高到低排序

## 注意事项

1. **统计仅显示前N项**
   - 文章分布：前10项
   - 字符分布：前15项
   - 义项分布：前10项

2. **义项显示截断**
   - 义项内容超过8个字符时会显示为"xxx..."
   - 完整内容可在题目详情中查看

3. **实时更新**
   - 每次生成题目后统计数据会自动更新
   - 统计基于当前生成的题目，不包含历史数据

## 最佳实践

### 1. 平衡文章分布

**目标**：让题目均匀分布在不同文章中

**方法**：
1. 查看文章分布统计
2. 如果某篇文章出现次数过多（如占比>30%）
3. 在文章权重图表中降低该文章的权重或取消选中
4. 重新生成题目并对比统计结果

### 2. 控制重点字频率

**目标**：确保重点字得到充分考察，但不过度集中

**方法**：
1. 查看字符分布统计
2. 如果某个字出现次数过多（如>题目总数的50%）
3. 在重点字权重编辑器中降低该字的权重
4. 或增加其他重点字的权重以平衡分布

### 3. 丰富义项覆盖

**目标**：避免重复考察相同义项，提高题目多样性

**方法**：
1. 查看义项分布统计
2. 如果某个义项出现次数过多
3. 使用"AI自动生成义项"功能增加该字的其他义项
4. 重新生成题目以提高义项多样性

## 常见问题

### Q: 为什么统计中的文章数量少于实际选择的文章数量？

A: 可能原因：
1. 某些文章没有足够的短句或义项数据
2. 某些文章的权重设置为0或未被选中
3. 题目数量较少，无法覆盖所有文章

### Q: 为什么某个重点字没有出现在统计中？

A: 可能原因：
1. 该字的义项数据不足（需要至少2个义项）
2. 该字的短句数量不足
3. 该字的权重设置过低
4. 题目数量较少，未能抽取到该字

### Q: 如何让题目更均匀地分布？

A: 建议：
1. 增加题目数量
2. 调整文章权重，降低高频文章的权重
3. 调整重点字权重，使用更均衡的权重分配
4. 扩大考察范围，包含更多文章

## 技术说明

### 统计算法

1. **文章统计**：
   ```
   遍历题目 -> 遍历选项 -> 提取短句 -> 查找源句子 -> 定位文章 -> 累加计数
   ```

2. **字符统计**：
   ```
   遍历题目 -> 提取考察字符 -> 累加计数 -> 排序
   ```

3. **义项统计**：
   ```
   遍历题目 -> 提取义项 -> 按"字符:义项"分组 -> 累加计数 -> 排序
   ```

### 性能优化

- 使用 `useMemo` 缓存统计结果
- 只在题目变化时重新计算
- 限制显示数量以提高渲染性能

## 更新日志

### v1.0.0 (2024-12-06)
- ✨ 新增题目统计模块
- 📊 支持文章、字符、义项三维度统计
- 🎨 美观的卡片式展示
- 🔄 实时更新统计数据
