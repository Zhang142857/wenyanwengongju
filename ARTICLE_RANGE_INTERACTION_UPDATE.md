# 文章区间选择交互优化

## 更新日期
2024-12-07

## 优化内容

### 问题描述
之前的区间选择轴存在以下问题：
- 鼠标单击就会创建一段区间，这是不合理的
- 缺少区间选中和删除功能

### 解决方案

#### 1. 拖拽创建区间
- **新行为**：鼠标必须按住并拖动至少1篇文章的距离才会创建区间
- **实现**：记录拖拽起始位置和当前位置，计算跨越的文章数量
- **判断条件**：`draggedArticles >= 1` 才会创建区间并选中文章

#### 2. 点击选中区间
- **新行为**：鼠标左键点击可以选中已创建的区间
- **视觉反馈**：选中的区间会显示黄色虚线边框高亮
- **实现**：维护 `selectedRange` 状态，记录选中区间的起始和结束索引

#### 3. Delete删除区间
- **新行为**：选中区间后按 Delete 键可以删除该区间
- **删除逻辑**：取消区间内所有文章的选中状态
- **实现**：监听全局 `keydown` 事件，检测 Delete 键

### 技术实现

#### 新增状态
```typescript
const [dragStartIndex, setDragStartIndex] = useState<number | null>(null);
const [selectedRange, setSelectedRange] = useState<{ start: number, end: number } | null>(null);
```

#### 核心逻辑
1. **拖拽检测**：计算拖拽距离，判断是否跨越至少1篇文章
2. **区间高亮**：在 SVG 中渲染选中区间的高亮矩形
3. **键盘监听**：使用 useEffect 监听 Delete 键事件

### 用户体验改进

#### 操作提示
更新了提示文本：
```
按住拖拽至少1篇文章创建区间 | 点击选中区间 | Delete删除选中区间 | 颜色深浅代表权重 | Ctrl+滚轮缩放
```

#### 视觉反馈
- **拖拽中**：显示蓝色半透明选择框
- **选中区间**：显示黄色虚线边框高亮
- **区间内文章**：边框加粗并变为黄色

### 兼容性
- 保持了原有的撤销/重做功能
- 保持了只读模式的限制
- 保持了缩放功能

## 测试建议
1. 测试单击不创建区间
2. 测试拖拽1篇文章创建区间
3. 测试拖拽多篇文章创建区间
4. 测试点击选中区间
5. 测试Delete删除选中区间
6. 测试只读模式下的行为
